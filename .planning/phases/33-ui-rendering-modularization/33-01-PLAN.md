---
phase: 33-ui-rendering-modularization
plan: 01
type: execute
wave: 1
depends_on: []
files_modified: [config.py, ecs/systems/ui_system.py]
autonomous: true

must_haves:
  truths:
    - "UI constants exist in config.py"
    - "LayoutCursor class is used for positioning in UISystem"
    - "Initial UI rects are defined using constants"
  artifacts:
    - path: "config.py"
      provides: "UI layout and color constants"
    - path: "ecs/systems/ui_system.py"
      provides: "LayoutCursor class and refactored initialization"
  key_links:
    - from: "ecs/systems/ui_system.py"
      to: "config.py"
      via: "importing new UI constants"
---

<objective>
Introduce UI layout constants and a dynamic Y-cursor to replace hardcoded positioning in `ui_system.py`.

Purpose: Establish the infrastructure for a modular UI system where elements stack dynamically rather than being placed at fixed coordinates.
Output: Refactored `config.py` with UI constants and `ui_system.py` with a `LayoutCursor` helper.
</objective>

<execution_context>
@/home/peter/.gemini/get-shit-done/workflows/execute-plan.md
@/home/peter/.gemini/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@config.py
@ecs/systems/ui_system.py
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add UI Layout and Color Constants to config.py</name>
  <files>config.py</files>
  <action>
    Add the following constants to the 'UI configuration' section of config.py:
    - UI_PADDING: 10
    - UI_MARGIN: 15
    - UI_LINE_SPACING: 22
    - UI_SECTION_SPACING: 35
    - UI_COLOR_BG_HEADER: (30, 30, 30)
    - UI_COLOR_BG_SIDEBAR: (40, 40, 40)
    - UI_COLOR_BORDER: (100, 100, 100)
    - UI_COLOR_TEXT_DIM: (150, 150, 150)
    - UI_COLOR_TEXT_BRIGHT: (255, 255, 255)
    - UI_COLOR_SECTION_TITLE: (200, 200, 200)
    - UI_BAR_HEIGHT: 18
  </action>
  <verify>
    Check config.py for the new constants.
  </verify>
  <done>
    Constants are defined and available for import.
  </done>
</task>

<task type="auto">
  <name>Task 2: Implement LayoutCursor and Refactor UISystem Initialization</name>
  <files>ecs/systems/ui_system.py</files>
  <action>
    - Define a `LayoutCursor` class at the top of ecs/systems/ui_system.py.
      It should store `x`, `y`, `width`, and `initial_y`.
      Methods: `advance(dy)` (increments y), `reset()` (restores y to initial_y), `move_to(x, y)`.
    - Update `UISystem.__init__` to use new constants from config.py.
    - Initialize a `self.sidebar_cursor` and `self.header_cursor` using the defined rects and padding.
  </action>
  <verify>
    Run main.py to ensure the game still launches and UI renders (even if not fully modular yet).
  </verify>
  <done>
    UISystem has a LayoutCursor and uses constants for initial setup.
  </done>
</task>

</tasks>

<verification>
Check that config.py contains UI_PADDING and UI_SECTION_SPACING.
Check that UISystem uses LayoutCursor for sidebar positioning.
</verification>

<success_criteria>
1. config.py contains all specified UI constants.
2. UISystem no longer uses raw values for header_rect and sidebar_rect initialization.
3. LayoutCursor is implemented and functional.
</success_criteria>

<output>
After completion, create `.planning/phases/33-ui-rendering-modularization/33-01-SUMMARY.md`
</output>
